datasource db {
    provider  = "postgresql"
    url       = env("DATABASE_URL")
    directUrl = env("DIRECT_URL")
}

generator client {
    provider = "prisma-client-js"
}

// Donation receipt jurisdictions
enum Jurisdiction {
    CRA
    IRS
    // Add additional jurisdictions as needed
}

model charity {
    id                        String             @id @default(uuid())
    charity_name              String?
    registered_office_address String?
    registration_number       String?
    contact_name              String?
    contact_email             String?
    contact_phone             String?
    wallet_address            String             @unique
    is_profile_complete       Boolean            @default(false)
    slug                      String?            @unique
    created_at                DateTime           @default(now())
    donation_receipts         donation_receipt[]
}

model donor {
    id                  String             @id @default(uuid())
    wallet_address      String             @unique
    email               String?            @unique
    first_name          String?
    last_name           String?
    address             String?
    donation_receipts   donation_receipt[]
    is_profile_complete Boolean            @default(false)
    created_at          DateTime           @default(now())
    updated_at          DateTime           @updatedAt
}

model donation_receipt {
    id                   String       @id @default(uuid())
    receipt_number       String       @unique
    donation_date        DateTime
    fiat_amount          Float
    transaction_hash     String
    jurisdiction         Jurisdiction @default(CRA)
    jurisdiction_details Json? // For example, IRS receipts might include fields like cost_basis, etc.
    charity_id           String?
    charity              charity?     @relation(fields: [charity_id], references: [id])
    donor_id             String?
    donor                donor?       @relation(fields: [donor_id], references: [id])

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt
}

model donation_receipt_counter {
    jurisdiction Jurisdiction @id
    counter      Int          @default(0)
}
